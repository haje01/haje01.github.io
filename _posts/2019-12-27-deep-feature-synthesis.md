---
layout: post
title: "심층 특성 합성: 데이터 과학 노력의 자동화를 위하여"
description: 
date: 2019-12-27
tags: [paper,study,draft]
---

원문: [Deep Feature Synthesis: Towards Automating Data Science Endeavors](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=10&cad=rja&uact=8&ved=2ahUKEwiA9ZqgztXmAhUDE4gKHYhrCDgQFjAJegQIBBAC&url=http%3A%2F%2Fwww.jmaxkanter.com%2Fstatic%2Fpapers%2FDSAA_DSM_2015.pdf&usg=AOvVaw1DpTqBAt1xvpH8gmQzuhBB)

의도:
- 좋은 논문을 알리기 위해 핵심 내용 중심으로 번역한 것이다.
- 모든 내용에 대한 저작권은 본문의 저자에게 있다.
- 누락이나 오류가 있을 수 있으니, 정확한 내용은 꼭 원문을 참고하기 바란다.

--- 

## 소개

데이터 과학은 데이터에서 통찰력, 지식 및 예측 모델을 도출하는 것으로 구성됩니다. 이 노력에는 한쪽 끝의 청소와 큐레이터, 다른 쪽 끝에 결과의 전파가 포함되며, 데이터 수집 및 동화도 포함될 수 있습니다. 데이터를 효율적으로 저장, 검색 및 처리 할 수있는 시스템 및 소프트웨어의 성공적인 개발과 확산 후, 이제는 예측적 또한 상관 관계적 분석으로 관심이 옮겨졌습니다. 우리의 목표는 이러한 노력을 보다 효율적이고 즐겁고 성공적으로 만드는 것입니다.

먼저, 우리는 KAGGLE에서 발표 한 것과 같은 많은 데이터 과학 문제와 컨퍼런스 내 경진대회(KDD 컵, IJCAI, ECML) 같은 많은 데이터 과학 문제가 몇 가지 공통된 속성을 가지고 있음을 관찰했습니다. 첫째, 데이터는 구조적이며 관계적이며 일반적으로 관계형 링크가 있는 테이블 세트로 표시됩니다. 둘째, 데이터는 복잡한 시스템과 인간 사이 상호작용의 일부 측면을 캡처합니다. 셋째, 제시된 문제는 인간 행동, 의사 결정 또는 활동의 일부 측면을 예측하려고 시도합니다(예 : 판매 후 고객이 다시 구매할지 여부 [IJCAI], 프로젝트가 기부자에 의해 자금을 지원 받을지 여부 예측 [KDD Cup 2014], 또는 택시 기사가 갈 수있는 곳 [ECML]).

예측 문제가 주어지면, 데이터 과학자는 먼저 특성(Feature)으로 알려진 변수를 만들어야 합니다. 데이터 과학자는 테이블에서 일부 정적 필드 (예 : 성별, 연령 등)를 특성으로 사용하여 시작한 다음, 직감을 통해 결과를 예측할 수 있을 것 같은 특화된 특성을 구성할 수 있습니다. 다음으로 과학자는 원시 필드를 다른 척도 값으로 변환하는 새로운 특성을 개발할 수 있습니다 (예 : "어떤 특성의 백분위수"). 이것은 그림 1의 첫 세 블록에 설명되어 있습니다.

![그림 1](/assets/2019-12-27-19-33-32.png)

> 그림 1. 전형적인 데이터 과학 노력. 분석가는 질문을 제기하면서 시작합니다: x 또는 y가 z와 상관되어 있는지 예측할 수 있습니까? 이러한 질문은 일반적으로 데이터를 보유한 비즈니스 또는 연구원의 요구에 따라 정의됩니다. 둘째, 예측 문제가 주어지면 데이터 엔지니어는 설명 변수를 가정하고 해당 변수를 추출하는 스크립트를 작성합니다. 이러한 변수 / 특성 및 표현을 고려할 때 기계 학습 연구원은 주어진 예측 목표에 대한 모델을 작성하고, 다양한 모델링 기술을 적용합니다. 현재 예측 문제에 대한 가장 일반적인 방법을 식별하기 위해 모델링 방법의 공간 내에서 선택을 합니다. 데이터 과학자는 모델을 작성, 반복 및 검증하기 위해 질문을 가정하고 변수를 형성하는 전체 프로세스를 거칠 수 있습니다.

## 심층 특성 합성

*심층 특성 합성(Deep Feature Synthesis)*은 관계형 데이터 집합에 대한 기능을 자동으로 생성하는 알고리즘입니다. 이 알고리즘은 기본적으로 데이터의 기본 필드에 대한 관계를 따른 다음, 최종 특성을 만들기 위해 해당 경로를 따라 수학 함수를 순차적으로 적용합니다. 계산을 순차적으로 쌓아가면서, 우리는 각각의 새로운 특성이 특정 깊이 $d$를 갖는 것으로 정의할 수 있다는 것을 알았습니다. 따라서 우리는 알고리즘을 *심층 특성 학습*이라고 부릅니다. 이 섹션에서는 심층 특성 학습의 동기를 설명하고, 특성 합성 추상화를 정의하고, 알고리즘을 제시합니다.

### A. 프로토타입 문제와 동기

전자상거래 웹 사이트에 대한 가상의 데이터 세트를 고려해 봅시다. 우리의 목표는 사용 가능한 모든 데이터를 기반으로 고객의 행동을 설명하는 특성을 계산하는 것입니다. 이 데이터 세트의 스키마는 그림 2에 표시되어 있습니다.

![그림 2](/assets/2019-12-28-21-03-26.png)

> 전자상거래 웹 사이트를 위한 단순화된 스키마. 4 개의 엔터티가 있습니다. 한 엔티티에서 다른 엔티티로의 화살표는 데이터베이스에서 첫 번째 엔티티가 두 번째 엔티티를 참조 함을 나타냅니다.

데이터 과학자처럼 생각하기 위해, 우리는 고객을 설명하는 특성(예 : "고객이 얼마나 자주 구매합니까?" 또는 "고객이 마지막으로 구매 한 후 얼마나 되었습니까?")으로 번역 될 수 있는 질문을 하는 것으로 시작할 수 있습니다. 또한 고객과 관련된 엔터티를 보고 이에 대해 질문 할 수도 있습니다(예 : "고객의 총 주문 가격은 얼마입니까?" 또는 "이 고객은 일반적으로 고급 또는 저렴한 제품을 구매합니까?"). 이러한 질문을 관계를 따르고, 값을 집계하고, 새 특성을 계산하는 것을 통해 특성으로 전환할 수 있습니다. 우리의 목표는 이러한 유형의 특성을 생성하거나, 프록시 수량으로 동작할 수 있는 계산을 생성 할 수 있는 알고리즘을 설계하는 것입니다.

### B. 특성 합성 추상화

심층 특성 합성에 대한 입력은 상호 연결된 엔터티의 집합 및 그것과 연관된 테이블입니다. 테이블에 있는 엔터티의 각 인스턴스마다 고유한 식별자가 있습니다. 선택적으로 엔티티는 관련 엔티티의 고유 식별자를 사용하여 그 인스턴스를 참조할수 있습니다. 엔터티의 인스턴스에는 숫자(numeric), 범주 형(categorical), 타임 스탬프(timestamp) 및 자유 텍스트(freetext) 타입 중 하나에 해당하는 특성이 있습니다.

주어진 데이터 세트의 표기 측면에서, 우리는 $E^{(1 ... K)}$로 엔터티를 나타냅니다. 여기서 각 엔터티 테이블은 $1 ... J$ 특성을 가집니다. 특정 항목을 $x^k_{i, j}$로 표시하는데, 이는 $k$ 번째 엔티티의 $i$ 번째 인스턴스에 대한 특성 $j$의 값입니다.

다음으로 우리는 엔터티와 그것의 데이터 테이블 그리고 관계 측면에서, *엔터티* 레벨과 *관계* 레벨에서 서로 다른 두 가지 레벨로 적용되는 여러 수학 함수를 정의합니다. 우리는 아래에서 이 함수들을 살펴볼 것입니다. 특성 조립의 대상인 엔터티 $E^k$를 생각해 봅시다. 표기상의 편의를 위해 특정 엔터티를 나타내는 데 사용되는 $k$를 생략하겠습니다.

첫 번째 특성 세트는 엔티티 $k$에만 해당하는 테이블의 특성 및 그 값을 고려하여 계산됩니다. 이것을 엔터티 특성이라고하며 아래에 설명합니다.

엔터티 특성 (`efeat`) : 엔터티 특성은 각 항목 $x_{i,j}$의 값을 계산하여 유도합니다. 이 특성은 배열 $x_{:,j}$에 요소별로 적용된 계산 함수를 기반으로 할 수 있습니다. 예를 들어 범주 형 문자열 데이터 유형을 사전 결정된 고유 숫자 값으로 변환하거나 숫자 값의 반올림과 처럼, 엔티티 테이블의 기존 특성을 다른 타입의 값으로 변환하는 함수가 있습니다. 다른 예로는 타임 스탬프를 주중일(weekday) (1-7), 월중일(day of the month) (1-30 / 31), 연중월(month of the year) (1-12) 또는 일중시(hour of the day) (1-24)의 4 가지 특성으로 변환하는 것이 있습니다.

이러한 특성에는 $j$ 번째 특성 $x_{:, j}$ 및 다음 식으로 주어지는 $x_{i,j}$에 대한 전체 값 세트에 함수를 적용하는 것도 포함됩니다.

![식 1](/assets/2019-12-28-22-49-40.png)

이러한 계산의 예로는 누적 분포 함수 (cdf) 기반 특성이 있습니다. 이 특성을 생성하기 위해 $x_{:,j}$에 대한 밀도 함수를 만들고, $x_{i,j}$ (또는 *백분위수*)의 누적 밀도 값을 평가하여 새로운 특성을 형성합니다.

두 번째 기능 세트는 두 개의 관련 엔티티 $E^l$ 및 $E^k$를 결합 분석하여 유도됩니다. 이 두 엔터티는 *순방향(forward)* 또는 *역방향(backward)* 의 두 가지 방법 중 하나로 관련됩니다.

순방향 : *순방향* 관계는 엔티티 $E^l$의 인스턴스 $m$과 $E^k$의 다른 엔티티 $i$의 단일 인스턴스 사이에 있습니다. $i$가 $m$에 대한 명시적인 의존성이 있기 때문에 이것은 *순방향* 관계로 간주됩니다. 위의 전자상거래 예에서, *Orders* 엔터티는 *Customers*와 순방향 관계를 갖습니다. 즉, *Orders* 테이블의 각 주문은 한 고객과 만 관련이 있습니다.

역방향 : 역방향 관계는 $E^k$의 인스턴스 $i$에서 순방향 관계를 갖는 $E^l$의 모든 인스턴스 $m = \{1...M\}$ 로의 관계입니다. 위와 같은 예에서 *Customers* 엔터티는 *Orders*와 역방향 관계가 있습니다. 즉, 많은 주문이 동일한 고객을 가리킬 수 있습니다.

직접 특성 (`dfeat`) : 직접 기능은 *순방향* 관계에 적용됩니다. 이들에서, 관련 엔티티 $i \in E^k$의 특성은 $m \in E^l$에 대한 특성으로 직접 변형됩니다.

관계형 특성 (`rfeat`) : 관계형 특성은 *역방향* 관계에 적용됩니다. 그것들은 $x^l_{:,j \vert e^k=i}$에 수학 함수를 적용하여 엔터티 $E^k$의 인스턴스 $i$에 대해 유도됩니다. 이것은 관련 엔티티 $E^l$의 특성 $j$에 대한 값의 모음이며, $E^k$의 식별자가 $e^k = i$ 인 엔티티 $E^l$의 특성 $j$의 모든 값을 추출하여 결합됩니다.

![식 2](/assets/2019-12-28-23-25-13.png)

`rfeat` 함수의 일부 예는 `min`, `max` 및 `count`입니다. 다른 `rfeat` 함수는 $x^l_{:,j \vert e^k=i}$에 대한 확률 밀도 함수에 적용될 수 있는 함수를 포함합니다.
